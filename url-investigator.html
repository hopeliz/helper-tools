<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>URL Investigator</title>
    <script src="https://kit.fontawesome.com/6a530a4831.js" crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: content-box;
        }

        body { font-family: Arial, sans-serif; }

        form { margin: 25px; }

        #url { width: 100%; }

        input {
            margin-bottom: 10px;
            padding: 5px;
        }

        h2 {
            margin-left: 25px;
            font-size: 14pt;
        }

        p { margin-bottom: 5px; }

        #results { display: hidden; }

        .results {
            background-color: #eee;
            margin: 25px 10px 25px 25px;
            border-radius: 7px;
            padding: 25px;
        }

        #title-results, 
        #domain-results,
        #alias-results {
            display: flex;
            align-items: center;
        }

        .results-text {
            width: 100%;
        }

        i {
            margin-left: 15px;
            font-size: 16pt;
            text-align: right;
        }
    </style>
</head>
<body>
    <form id="url-form">
        <p><label for="url">URL: </label></p>
        <input type="text" id="url" name="url"><br>
        <input type="button" value="Investigate" onclick="investigateURL()">
    </form>
    <h2>Domain:</h2>
    <div id="domain-results" class="results">
        <div id="domain-text" class="results-text"></div>
        <i class="fa-regular fa-copy" onclick="copyToClipboard('domain-text')"></i>
    </div>
    <h2>Alias/Slug:</h2>
    <div id="alias-results" class="results">
        <div id="alias-text" class="results-text"></div>
        <i class="fa-regular fa-copy" onclick="copyToClipboard('alias-text')"></i>
    </div>
    <h2>Try to Search:</h2>
    <div id="title-results" class="results">
        <div id="title-text" class="results-text"></div>
        <i class="fa-regular fa-copy" onclick="copyToClipboard('title-text')"></i>
    </div>
    
    <script>
        function investigateURL() {

            let parsedURL = document.forms["url-form"].url.value.split("/");
            let domain = "";

            console.log(parsedURL);

            // Get pieces
            
            // Check if URL starts with ww...
            if (parsedURL[2].split(".")[0][0] != "w" && parsedURL[2].split(".")[0][1] != "w" && parsedURL[2].length > 3) {
                domain = parsedURL[2].split(".")[0] + "." + parsedURL[2].split(".")[1];
            }
            else {
                domain = parsedURL[2].split(".")[1] + "." + parsedURL[2].split(".")[2];
            }
            
            // Removes empty last indicies
            while (parsedURL[parsedURL.length - 1] == "") {
                parsedURL.pop();
            }
            
            let alias = parsedURL[parsedURL.length - 1];
            
            let title = alias.replace(/-/g," ");

            // Process results
            // I don't know why this needs to be ran repeatedly to work

            for (let i = 0; i < 5; i ++) {
                title = checkForSymbols(title, false);
            }

            // Print results
            document.getElementById("domain-text").innerHTML = domain;
            document.getElementById("alias-text").innerHTML = alias;
            document.getElementById("title-text").innerHTML = title;
        }

        function checkForSymbols(textToCheck, includeChars) { 
            let resultText = textToCheck;

            //Check for spaces
            if (textToCheck.indexOf("%20") != -1) {
                resultText = textToCheck.replace(/%20/g," ");
            }

            //Check for mdash
            if (textToCheck.indexOf("%E2%80%93") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%E2%80%93/g,"&mdash;");
                }
                else {
                    resultText = textToCheck.replace(/%E2%80%93/g,"");
                }
            }

            //Check for doublequotes
            if (textToCheck.indexOf("%22") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%22/g,"&quot;");
                }
                else {
                    resultText = textToCheck.replace(/%22/g,"");
                }
            }
            
            //Check for left double quotes
            if (textToCheck.indexOf("%E2%80%9C") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%E2%80%9C/g,"&quot;");
                }
                else {
                    resultText = textToCheck.replace(/%E2%80%9C/g,"");
                }
            }

            //Check for right double quotes
            if (textToCheck.indexOf("%e2%80%9d") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%e2%80%9d/g,"&quot;");
                }
                else {
                    resultText = textToCheck.replace(/%e2%80%9d/g,"");
                }
            }

            //Check for tick
            if (textToCheck.indexOf("%E2%80%99") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%E2%80%99/g,"&apos;");
                }
                else {
                    resultText = textToCheck.replace(/%E2%80%99/g,"");
                }
            }

            //Check for copyright symbol
            if (textToCheck.indexOf("%C2%A9") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%C2%A9/g,"&copy;");
                }
                else {
                    resultText = textToCheck.replace(/%C2%A9/g,"");
                }
            }

            //Check for greater than
            if (textToCheck.indexOf("%3E") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%3E/g,"&gt;");
                }
                else {
                    resultText = textToCheck.replace(/%3E/g,"");
                }
            }

            //Check for lesser than
            if (textToCheck.indexOf("%3C") != -1) {
                if (includeChars) {
                    resultText = textToCheck.replace(/%3C/g,"&lt;");
                }
                else {
                    resultText = textToCheck.replace(/%3C/g,"");
                }
            }

            return resultText;
        }

        function copyToClipboard(textToCopy) {
            let copiedText = document.getElementById(textToCopy).innerHTML;

            navigator.clipboard.writeText(copiedText);

            alert("Title has been copied.");

            return copiedText;
        }
    </script>
</body>
</html>